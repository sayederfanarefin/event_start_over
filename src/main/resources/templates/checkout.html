<!DOCTYPE html>
<html lang="en-US" itemscope="itemscope"
	itemtype="http://schema.org/WebPage">
<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Checkout | Event Factory</title>

<div th:replace="commons :: head"></div>
</head>

<body class="page home page-template-default">
	<div id="page" class="hfeed site">
		<a class="skip-link screen-reader-text" href="#site-navigation">Skip
			to navigation</a> <a class="skip-link screen-reader-text" href="#content">Skip
			to content</a>


		<div th:replace="iCommons :: header"></div>



		<div id="content" class="site-content" tabindex="-1">
			<div class="container">
				<div id="primary" class="content-area">
					<main id="main" class="site-main">


					<article class="page type-page status-publish hentry">
						<header class="entry-header">
							<h1 itemprop="name" class="entry-title"
								style="padding-top: 30px;">Checkout</h1>
						</header>
						<!-- .entry-header -->

						<form enctype="multipart/form-data" th:action="@{/placeOrder}"
							th:object="${order}" class="checkout woocommerce-checkout"
							method="post" name="fuckCheckout" id="fuckCheckout">
							<div id="customer_details" class="col2-set">
								<div class="col-1">
									<div class="woocommerce-billing-fields">

										<h3>Billing Details</h3>

										<p id="billing_first_name_field"
											class="form-row form-row form-row-first validate-required">
											<label class="" for="billing_first_name">First Name <abbr
												title="required" class="required">*</abbr></label><input type="text"
												id="billing_first_name" name="billing_first_name"
												class="input-text " th:placeholder="${userx.firstName}"
												th:value="${userx.firstName}">
										</p>

										<p id="billing_last_name_field"
											class="form-row form-row form-row-last validate-required">
											<label class="" for="billing_last_name">Last Name <abbr
												title="required" class="required">*</abbr></label><input type="text"
												th:placeholder="${userx.lastName}"
												th:value="${userx.lastName}" id="billing_last_name"
												name="billing_last_name" class="input-text ">
										</p>
										<div class="clear"></div>

										<p id="billing_company_field"
											class="form-row form-row form-row-wide">
											<label class="" for="billing_company">Company Name</label><input
												type="text" th:placeholder="${userx.companyName}"
												th:value="${userx.companyName}" id="billing_company"
												name="billing_company" class="input-text ">
										</p>

										<p id="billing_email_field"
											class="form-row form-row form-row-first validate-required validate-email">
											<label class="" for="billing_email">Email Address <abbr
												title="required" class="required">*</abbr></label><input
												type="email" th:placeholder="${userx.email}"
												th:value="${userx.email}" id="billing_email"
												name="billing_email" class="input-text ">
										</p>

										<p id="billing_phone_field"
											class="form-row form-row form-row-last validate-required validate-phone">
											<label class="" for="billing_phone">Phone <abbr
												title="required" class="required">*</abbr></label><input type="tel"
												th:placeholder="${userx.phone}" th:value="${userx.phone}"
												id="billing_phone" name="billing_phone" class="input-text ">
										</p>
										<div class="clear"></div>


										<p id="billing_address_1_field"
											class="form-row form-row form-row-wide address-field validate-required">
											<label class="" for="billing_address_1">Address <abbr
												title="required" class="required">*</abbr></label><input type="text"
												th:placeholder="${userx.address}"
												th:value="${userx.address}" id="billing_address_1"
												name="billing_address_1" class="input-text ">
										</p>


										<div class="clear"></div>

										<p id="order_comments_field" class="form-row form-row notes">
											<label class="" for="order_comments">Order Notes</label>
											<textarea cols="5" rows="2"
												placeholder="Notes about your order, e.g. special notes for delivery."
												id="order_comments" class="input-text "
												name="order_comments"></textarea>
										</p>

									</div>
								</div>

								<div class="col-2">
									<h3>Your order</h3>
									<div class="woocommerce-shipping-fields">


										<div class="woocommerce-checkout-review-order"
											id="order_review">
											<table
												class="shop_table woocommerce-checkout-review-order-table"
												id="mytable">
												<thead>
													<tr>
														<th class="product-name">Service</th>
														<th class="product-total">Total</th>
													</tr>
												</thead>
												<tbody>


												</tbody>
												<tfoot>

													<tr class="cart-subtotal">
														<th>Subtotal</th>
														<td><span class="amount" id="sub-total"></span></td>
													</tr>

													<!--      <tr class="shipping">
                                                    <th>Shipping</th>
                                                    <td data-title="Shipping">Flat Rate: <span class="amount">$300.00</span> <input type="hidden" class="shipping_method" value="international_delivery" id="shipping_method_0" data-index="0" name="shipping_method[0]"></td>
                                                </tr> -->

													<tr class="order-total">
														<th>Total</th>
														<td><strong><span class="amount"
																id="final-total"></span></strong></td>
													</tr>
												</tfoot>
											</table>

											<div class="woocommerce-checkout-payment" id="payment">
												<ul class="wc_payment_methods payment_methods methods">
													<li class="wc_payment_method payment_method_bacs"><input
														type="radio" data-order_button_text="" checked="checked"
														value="bacs" name="payment_method" class="input-radio"
														id="payment_method_bacs"> <label
														for="payment_method_bacs">Direct Bank Transfer</label> <!-- <div class="payment_box payment_method_bacs">
                                                       <p>Make your payment directly into our bank account. Please use your Order ID as the payment reference. Your order won’t be shipped until the funds have cleared in our account.</p>
                                                    </div> --></li>
													<li class="wc_payment_method payment_method_cheque"><input
														type="radio" data-order_button_text="" value="cheque"
														name="payment_method" class="input-radio"
														id="payment_method_cheque"> <label
														for="payment_method_cheque">Cheque Payment </label>
														<div style="display: none;"
															class="payment_box payment_method_cheque">
															<p>Please send your cheque to Store Name, Store
																Street, Store Town, Store State / County, Store
																Postcode.</p>
														</div></li>
													<li class="wc_payment_method payment_method_cod"><input
														type="radio" data-order_button_text="" value="cod"
														name="payment_method" class="input-radio"
														id="payment_method_cod"> <label
														for="payment_method_cod">Cash on Delivery</label>
														<div style="display: none;"
															class="payment_box payment_method_cod">
															<p>Pay with cash upon delivery.</p>
														</div></li>

												</ul>
												<div class="form-row place-order">

													<p class="form-row terms wc-terms-and-conditions">
														<input type="checkbox" id="terms" name="terms"
															class="input-checkbox" required="required"> <label
															class="checkbox" for="terms">I’ve read and accept
															the <a target="_blank" href="/termsAndConditions">terms
																&amp; conditions</a> <span class="required">*</span>
														</label> <input type="hidden" value="1" name="terms-field">
													</p>

													<input type="submit" data-value="Place order"
														value="Place order" class="button alt">
												</div>
											</div>
										</div>


									</div>
								</div>
							</div>




						</form>
					</article>

					</main>
					<!-- #main -->
				</div>
				<!-- #primary -->
			</div>
			<!-- .col-full -->
		</div>
		<!-- #content -->





		<div th:replace="commons :: footer"></div>

	</div>
	<!-- #page -->
	<script type="text/javascript">
		function iniata() {

			var cartJson;

			var cartRaw = localStorage.getItem('cartx');
			if (cartRaw != null) {
				cartJson = JSON.parse(cartRaw);

				console.log(cartJson);

				var total = 0;

				var i;
				for (i = 0; i < cartJson.length; i++) {

					console.log('goging for it');
					var cartItem = cartJson[i];
					console.log(cartItem);

					var tableRef = document.getElementById("mytable")
							.getElementsByTagName('tbody')[0];
					var newRow = tableRef.insertRow(tableRef.rows.length - 1);

					newRow.insertCell(0).appendChild(
							document.createTextNode(cartItem.name + " x "
									+ cartItem.quantity));

					newRow.insertCell(1).appendChild(
							document.createTextNode(Number(cartItem.quantity)
									* Number(cartItem.price) + ' BDT'));

					total += Number(cartItem.quantity) * Number(cartItem.price);
					document.getElementById("sub-total").innerHTML = total
							+ ' BDT';
					document.getElementById("final-total").innerHTML = total
							+ ' BDT';

					console.log("======================xxxxxxxxxxxxxxxxxxx");
				}
			}
		}

		window.onload = iniata;

		codeAddress();

		$(document).ready(function() {
			$('#fuckCheckout').on('submit', function(e) {
				e.preventDefault();

				var billing_first_name = $('#billing_first_name').val();
				var billing_last_name = $('#billing_last_name').val();
				var billing_company = $('#billing_company').val();
				var billing_email = $('#billing_email').val();
				var billing_phone = $('#billing_phone').val();
				var billing_address_1 = $('#billing_address_1').val();
				var order_comments = $('#order_comments').val();
				
				var user = {};
				
				
				user["firstName"] = billing_first_name;
				user["lastName"] = billing_last_name;
				user["companyName"] = billing_company;
				user["email"] = billing_email;
				user["phone"] = billing_phone;
			//	user["address"] = billing_address_1;
			//	user["id"] = order_comments;
				

			var order = {};
			order["subTotal"] = billing_first_name;
			order["note"] = order_comments;
			order["total"] = 666;
			order["cuponCode"] = order_comments;
			order["paymentType"] = order_comments;
			order["user"] = user;
			
			var orderItems = [];
			
			
			var cartJson;
			var cartRaw = localStorage.getItem('cartx');
			if (cartRaw != null) {
				cartJson = JSON.parse(cartRaw);
				
				var i;
				for (i = 0; i < cartJson.length; i++) { 
					var cartItem = cartJson[i];
					var item = {};
					
					item["quantity"] = Number(cartItem.quantity);
					item["price"] = cartItem.amount;
					
					var service = {};
					service["id"] = Number(cartItem.id);
					
					item["service"] = service;
					
					orderItems.push(item);
				}
			} 
			
			order["orderItems"] = orderItems;
			
			
			console.log(order);
			
				$.ajax({
					url : '/placeOrder',
					type : 'post',
					
					data: 'test', //JSON.stringify(order)
			        dataType: 'json',
					done : function(data) {
						
						alert('done!');
					}
				});

			});
		});
	</script>

</body>
</html>
